<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org/">
<head>
    <title>Index</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
    
<body>
    <!-- Check if 'admin' is not null to show logout link -->
    <a th:if="${admin != null}" th:href="@{/logout}" class="btn btn-primary">Logout</a>
        
    <h5>
        <a th:href="@{/createAdminItems}" class="btn btn-success">Create New</a>
    </h5>
    
    <form th:action="@{/searchAdminItems}" method="get" class="mb-3">
        <div class="input-group">
            <input type="text" name="name" class="form-control" placeholder="Search by name...">
            <button type="submit" class="btn btn-outline-primary">Search</button>
        </div>
    </form>
    
    <h3>List</h3>
    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>#Id</th>
                <th>Name</th>
                <th>Brand</th>
                <th>Description</th>
                <th>Price</th>
                <th>Stock</th>
                <th>Type</th>
                <th>Image</th>
                <th>Created Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="f : ${list}">
                <td th:text="${f.item_id}"></td>
                <td th:text="${f.name}"></td>
                <td th:text="${f.brand}"></td>
                <td th:text="${f.description}"></td>
                <td th:id="'price-' + ${f.item_id}" th:text="${f.price}"></td>
                <td th:text="${f.stock}"></td>
                <td th:text="${f.type}"></td>
                <td><img th:src="@{'/images/'+${f.image}}" width="100" height="auto"/></td>
                <td th:text="${f.created_dt}"></td>
                <td>
                    <a th:href="@{/editAdminItems/{id}(id=${f.item_id})}" class="btn btn-info">Edit</a>
                    <a th:href="@{/deleteAdminItems/{id}(id=${f.item_id})}" class="btn btn-danger">Delete</a>
                </td>
            </tr>
        </tbody>
    </table>
    
    <div class="pagination" th:if="${name != null}">
        <ul class="pagination">
            <li th:class="${currentPage == 0} ? 'page-item disabled' : 'page-item'">
                <a th:href="@{/searchAdminItems(name=${name},pageNumber=0,pageSize=${pageSize})}" class="page-link">First</a>
            </li>
            <li th:class="${currentPage == 0} ? 'page-item disabled' : 'page-item'">
                <a th:href="@{/searchAdminItems(name=${name},pageNumber=${currentPage - 1},pageSize=${pageSize})}" class="page-link">Previous</a>
            </li>
            <li th:class="${currentPage >= totalPages - 1} ? 'page-item disabled' : 'page-item'">
                <a th:href="@{/searchAdminItems(name=${name},pageNumber=${currentPage + 1},pageSize=${pageSize})}" class="page-link">Next</a>
            </li>
            <li th:class="${currentPage >= totalPages - 1} ? 'page-item disabled' : 'page-item'">
                <a th:href="@{/searchAdminItems(name=${name},pageNumber=${totalPages - 1},pageSize=${pageSize})}" class="page-link">Last</a>
            </li>
        </ul>
    </div>

    <div class="pagination" th:if="${name == null}">
    <ul class="pagination justify-content-center">

        <!-- First Page -->
        <li th:class="${currentPage == 0} ? 'page-item disabled' : 'page-item'">
            <a th:href="@{/indexAdminItems(pageNumber=0,pageSize=${pageSize})}" class="page-link">First</a>
        </li>

        <!-- Previous Page -->
        <li th:class="${currentPage == 0} ? 'page-item disabled' : 'page-item'">
            <a th:href="@{/indexAdminItems(pageNumber=${currentPage - 1},pageSize=${pageSize})}" class="page-link">Previous</a>
        </li>

        <!-- Pages Loop -->
        <th:block th:if="${totalPages > 1}">
            <th:block th:each="pageNumber : ${#numbers.sequence(0, totalPages - 1)}">
                <li th:class="${pageNumber == currentPage} ? 'page-item active' : 'page-item'">
                    <a th:href="@{/indexAdminItems(pageNumber=${pageNumber},pageSize=${pageSize})}" class="page-link" th:text="${pageNumber + 1}"></a>
                </li>
            </th:block>
        </th:block>

        <!-- Next Page -->
        <li th:class="${currentPage >= totalPages - 1} ? 'page-item disabled' : 'page-item'">
            <a th:href="@{/indexAdminItems(pageNumber=${currentPage + 1},pageSize=${pageSize})}" class="page-link">Next</a>
        </li>

        <!-- Last Page -->
        <li th:class="${currentPage >= totalPages - 1} ? 'page-item disabled' : 'page-item'">
            <a th:href="@{/indexAdminItems(pageNumber=${totalPages - 1},pageSize=${pageSize})}" class="page-link">Last</a>
        </li>

    </ul>
</div>

    <!-- JavaScript to convert scientific notation to decimal -->
    <script>
        function formatScientificNotation() {
            let priceElements = document.querySelectorAll('[id^="price-"]');
            priceElements.forEach(element => {
                let scientificNotation = element.innerText;
                if (scientificNotation !== null && scientificNotation !== '') {
                    let decimalNumber = Number(scientificNotation);
                    if (!isNaN(decimalNumber)) {
                        element.innerText = decimalNumber;
                    }
                }
            });
        }
        window.onload = formatScientificNotation;
    </script>
</body>
</html>